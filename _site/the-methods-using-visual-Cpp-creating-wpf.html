<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN">

<head prefix="og: http://ogp.me/ns#">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="applicable-device" content="pc,mobile" />
	<meta name="apple-mobile-web-app-title" content="极客玩家大白"/>
	<meta name="google" value="notranslate"/>

    <!-- simple jekyll search -->
    <script src="//cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.11/dest/simple-jekyll-search.min.js"></script>

	<!-- Favicon Icon -->
	<link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico">
    <link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png">
    <link rel="shortcut icon" sizes="32x32" href="/assets/images/favicon.png">
    <link rel="apple-touch-icon" href="/assets/images/favicon.png">
	<link rel="apple-touch-icon-precomposed" href="/assets/images/favicon.png">
	<link rel="search" type="application/opensearchdescription+json" href="https://geekplayers.com/search.json" title="极客玩家大白" />

	<meta name="theme-color" content="#cc0000">
	<meta name="msapplication-TileColor" content="#cc0000">
	<meta name="msapplication-TileImage" content="https://geekplayers.com/assets/images/better-me.jpg">

    <!-- Start Alexa Certify Javascript -->
    <script type="text/javascript">
        _atrk_opts = { atrk_acct: "K78pv1Y1Mn20Io", domain: "geekplayers.com", dynamic: true };
        (function () { var as = document.createElement('script'); as.type = 'text/javascript'; as.async = true; as.src = "https://certify-js.alexametrics.com/atrk.js"; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(as, s); })();
    </script>
    <noscript><img src="https://certify.alexametrics.com/atrk.gif?account=K78pv1Y1Mn20Io" style="display:none" height="1"
            width="1" alt="" /></noscript>
    <!-- End Alexa Certify Javascript -->

    <meta name="google-site-verification" content="GtBOHqwkUyIwJzqdPZ1VheMXW4edMcCJwjFJx5kGdWo" />
    <meta name="google-site-verification" content="41OWG5Vo9v4bjss_dr9CXfFGqd6FOE6iz-amoUsSC4U" />  <!-- Submit github.io to g. -->
    <meta name="google-site-verification" content="ITq_FdS8-Xx5YYhrXsVuWxj1QSFF0GITF53q1O0cMSQ" /> <!-- Submit github.com to g. -->
    <meta name="baidu-site-verification" content="yML3Kpovuo" />
    <meta name="baidu-site-verification" content="code-ZdUPa21nv6" /> <!-- Submit github.com to bd. -->
    <meta name="360-site-verification" content="49ed3d11f562a12a5ba68d3c6d2115b0" />
    <meta name="sogou_site_verification" content="53WDIeIDAM" /> <!-- Submit github.io to sg. -->
    <meta name="msvalidate.01" content="0FE0D36F099AFBB1CAC652EF20A2437F" />

	<title>用Visual C++创建WPF项目的三种主要方法_极客玩家大白</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
    <meta name="keywords" content="Python, 大白, VR, 大奔SEO, 大白SEO, 大白技术控, LeetCode, .NET, WPF, "C#", .NET Core, PHP, geekplayer, geekplayers, 极客玩家, RSS, k8s, 生活故事, 一线, 开发者, 编程, 代码, 开源, IT网站,Developer, Programmer, Coder, Geek, IT技术博客">
    
	<meta name="description" content="用Visual C++创建WPF项目的三种主要方法">
	<meta name="description" property="og:description" content="用Visual C++创建WPF项目的三种主要方法" />
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
	
    <!-- Facebook and Twitter integration -->
    <meta property="og:title" content="用Visual C++创建WPF项目的三种主要方法 | 极客玩家大白"/>
    <meta property="og:image" content="https://geekplayers.com/assets/images/better-me.jpg"/> <meta property="og:image:width" content="266"> <meta property="og:image:height" content="266">
	<meta property="og:locale" content="zh_cn">
	<meta property="og:updated_time" content="2020-10-03T19:43:26+08:00">
    <meta property="og:url" content="http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html"/>
    <meta property="og:site_name" content="极客玩家大白"/>
    <meta property="og:description" content="用Visual C++创建WPF项目的三种主要方法"/>

	<meta property="og:type" content="article">
	<meta property="article:section" content="大白技术控">
	<meta property="og:image:secure_url" content="https://geekplayers.com/assets/images/better-me.jpg"/>
	<meta property="og:image:alt" content="极客玩家大白">
	<meta property="article:published_time" content="2020-06-28T00:00:00+08:00">
	<meta property="article:modified_time" content="2020-10-03T19:43:26+08:00">
	
	<meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@yanglr">
    <meta name="twitter:title" content="Bravo Yeung" />
    <meta name="twitter:image" content="https://geekplayers.com/assets/images/better-me.jpg" />
    <meta name="twitter:url" content="http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html" />
    <meta name="twitter:description" content="用Visual C++创建WPF项目的三种主要方法" />
  
    <link rel="canonical" href="http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html">
    <link rel="alternate" type="application/rss+xml" title="极客玩家大白 RSS feed" href="http://localhost:4000/feed.xml">
    <link rel="sitemap" type="application/xml" title="极客玩家大白 Sitemap" href="http://localhost:4000/sitemap.xml" />

	<script type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@graph": [
				{
					"@type": "ImageObject",
					"@id": "https://geekplayers.com/assets/images/better-me.jpg",
					"inLanguage": "zh-CN",
					"url": "https://geekplayers.com/assets/images/better-me.jpg",
					"width": 266,
					"height": 266,
					"caption": "用Visual C++创建WPF项目的三种主要方法 | 极客玩家大白"
				},
				{
					"@type": "WebPage",
					"@id": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html",
					"url": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html",
					"name": "用Visual C++创建WPF项目的三种主要方法 | 极客玩家大白",
					"isPartOf": {
						"@id": "http://localhost:4000"
					},
					"primaryImageOfPage": {
						"@id": "http://localhost:4000"
					},
					"datePublished": "2020-06-28T00:00:00+08:00",
					"dateModified": "2020-10-03T19:43:26+08:00",
					"description": "用Visual C++创建WPF项目的三种主要方法",
					"inLanguage": "zh-CN",
					"potentialAction": [
						{
							"@type": "ReadAction",
							"target": [
								"http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html"
							]
						}
					]
				},
				{
					"@type": "Article",
					"@id": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html",
					"isPartOf": {
						"@id": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html"
					},
					"author": {
						"@id": "http://localhost:4000"
					},
					"headline": "用Visual C++创建WPF项目的三种主要方法 | 极客玩家大白",
					"datePublished": "2020-06-28T00:00:00+08:00",
					"dateModified": "2020-10-03T19:43:26+08:00",
					"commentCount": 30,
					"publisher": {
						"@id": "http://localhost:4000"
					},
					"image": {
						"@id": "https://geekplayers.com/assets/images/better-me.jpg"
					},
					"articleSection": "用Visual C++创建WPF项目的三种主要方法",
					"inLanguage": "zh-CN",
					"potentialAction": [
						{
							"@type": "CommentAction",
							"name": "Comment",
							"target": [
								"http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html"
							]
						}
					]
				},
				{
					"@type": "Person",
					"@id": "http://localhost:4000",
					"name": "极客玩家大白"
				},
				{
					"@context": "https://schema.org/",
					"@type": "Recipe",
					"name": "大白技术控",
					"description": "大白技术控!",
					"author": {
						"@type": "Person",
						"name": "Bravo Yeung"
					},
					"image": [
						"https://geekplayers.com/assets/images/better-me.jpg"
					],
					"url": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html",
					"recipeIngredient": [
						"第1步",
						"第2步",
						"第3步",
						"第4步"
					],
					"recipeInstructions": [
						{
							"@type": "HowToStep",
							"text": "第1步",
							"url": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html#step-1"
						},
						{
							"@type": "HowToStep",
							"text": "第2步",
							"url": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html#step-2"
						},
						{
							"@type": "HowToStep",
							"text": "第3步",
							"url": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html#step-3"
						}
					],
					"datePublished": "2020-06-28T00:00:00+08:00",
					"@id": "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html",
					"isPartOf": {
						"@id": "http://localhost:4000"
					},
					"mainEntityOfPage": "http://localhost:4000"
				}
			]
		}
	</script>

    <!-- Third-Party CSS -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="//geekplayers.com/bower_components/octicons/octicons/octicons.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/bower_components/hover/css/hover-min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/bower_components/primer-markdown/dist/user-content.min.css">
    <link rel="stylesheet" href="//geekplayers.com/assets/css/syntax.css">
    <link rel="stylesheet" href="//geekplayers.com/assets/css/sidebar-post-nav.css">

    <!-- My CSS -->
    <link rel="stylesheet" href="//geekplayers.com/assets/css/common.css">

    <!-- CSS set in page -->
    
    <!-- <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/assets/css/index.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/assets/css/sidebar-popular-repo.css"> -->

    <!-- CSS set in layout -->
    
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/assets/css/sidebar-post-nav.css">
    

    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@v4.6.3/css/font-awesome.min.css">

    <script type="text/javascript" src="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/bower_components/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

</head>


    <body>

    <script>
        (function () {
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

    <!-- baidu analyisis -->
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?87596be0014a64eee1571944c5130a8e";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-176595919-1">
    </script>
    
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-176595919-1');
    </script>
    
    <script>
        (function () {
            var src = "https://jspassport.ssl.qhimg.com/11.0.1.js?d182b3f28525f2db83acfaaf6e696dba";
            document.write('<script src="' + src + '" id="sozz"><\/script>');
        })();
    </script>

    <header class="site-header">
    <div class="site-header-topbar">
        <div class="container">
            <div class="topbar-menu">
                
                <div class="item">
                    <a href="/news/"
                       target="_self"
                       title="SEO动态">
                        SEO动态
                    </a>
                </div>
                
                <div class="item">
                    <a href="/dwz/"
                       target="_self"
                       title="短链接">
                        短链接
                    </a>
                </div>
                
                <div class="item">
                    <a href="/python.html"
                       target="_self"
                       title="Python">
                        Python
                    </a>
                </div>
                
                <div class="item">
                    <a href="/it.html"
                       target="_self"
                       title="IT">
                        IT
                    </a>
                </div>
                
                <div class="item">
                    <a href="/zsxq.html"
                       target="_self"
                       title="星球">
                        星球
                    </a>
                </div>
                
                <div class="item">
                    <a href="/life.html"
                       target="_self"
                       title="故事">
                        故事
                    </a>
                </div>
                
                <div class="item">
                    <a href="/link.html"
                       target="_self"
                       title="友链">
                        友链
                    </a>
                </div>
                
            </div>
        </div>
    </div>
    <div class="container">
        <h2><strong><a id="site-header-brand" href="/" title="极客玩家大白">
                <span class="octicon octicon-gist-secret"></span>
                极客玩家大白
            </a></strong>
        </h2>
        <nav class="site-header-nav" role="navigation">
            
            <div class=" site-header-nav-item hvr-underline-from-center">
                <a href="/algo.html"
                   target="_self"
                   title="算法">
                    算法
                </a>
                
            </div>
            
            <div class=" site-header-nav-item hvr-underline-from-center">
                <a href="/dabenSeo.html"
                   target="_blank"
                   title="大奔SEO">
                    大奔SEO
                </a>
                
                <ul class="submenu">
                    
                    <li><a href="/dabaiSEO.html" 
                           target="_blank"
                     >大白SEO</a></li>
                    
                </ul>
                
            </div>
            
            <div class=" site-header-nav-item hvr-underline-from-center">
                <a href="/dotnet.html"
                   target="_blank"
                   title=".NET">
                    .NET
                </a>
                
                <ul class="submenu">
                    
                    <li><a href="/csharp.html" 
                           target=""
                     >C#</a></li>
                    
                    <li><a href="/wpf.html" 
                           target=""
                     >WPF</a></li>
                    
                </ul>
                
            </div>
            
            <div class=" site-header-nav-item hvr-underline-from-center">
                <a href="/k8s.html"
                   target="_self"
                   title="k8s">
                    k8s
                </a>
                
                <ul class="submenu">
                    
                    <li><a href="/k8s.html" 
                           target=""
                     >k8s</a></li>
                    
                </ul>
                
            </div>
            
            <div class=" site-header-nav-item hvr-underline-from-center">
                <a href="/archives.html"
                   target="_self"
                   title="Archives">
                    Archives
                </a>
                
            </div>
            
            <div class=" site-header-nav-item hvr-underline-from-center">
                <a href="/tools/"
                   target="_blank"
                   title="Tools">
                    Tools
                </a>
                
                <ul class="submenu">
                    
                    <li><a href="/run-liquild-online.html" 
                           target=""
                     >Run Liquid now</a></li>
                    
                    <li><a href="/run-liquild-online-pro.html" 
                           target=""
                     >Run Liquid now Pro</a></li>
                    
                </ul>
                
            </div>
            
            <div class=" site-header-nav-item hvr-underline-from-center">
                <a href="/about.html"
                   target="_self"
                   title="About">
                    About
                </a>
                
            </div>
            
        </nav>
    </div>
</header>


        <div class="content">
            <section class="jumbotron geopattern" data-pattern-id="用Visual C++创建WPF项目的三种主要方法">
    <div class="container">
        <div id="jumbotron-meta-info">
            <h1 style="font-size: 45px;">
                <a class="hvr-underline-from-center" style="display: initial !important;" href="/the-methods-using-visual-Cpp-creating-wpf.html" title="用Visual C++创建WPF项目的三种主要方法_极客玩家大白" target="_self" rel="canonical">用Visual C++创建WPF项目的三种主要方法</a>
            </h1>

            <span class="meta-info">
                

                
                
                    <i class="fa fa-user" aria-hidden="true"></i> <a href='http://localhost:4000'>Bravo Yeung</a>
                

                
                                
                
                <span class="octicon octicon-calendar"></span> <font style="color: #ddd;">2020/06/28 00:00:00</font>
                
            </span>
            
            <p style="margin-bottom: 0 !important;">
                
                
                
                
                    
                    <font style="color: #ddd;"><i class="fa fa-folder-open" aria-hidden="true"></i></font>
                    
                        <a style='background-color: #16a085 !important; padding: 2px 6px; border-radius: 4px !important;font-size: 15px;overflow: scroll;' 
                        href="/categories/wpf">WPF</a>
                    
                        <a style='background-color: #16a085 !important; padding: 2px 6px; border-radius: 4px !important;font-size: 15px;overflow: scroll;' 
                        href="/categories/c">C++</a>
                    
                                    
                
                <!-- <p>out index:1</p>
                <p>size: 2</p> -->
                
                
                                    
                
                <!-- <p>out index:2</p>
                <p>size: 14</p> -->
                
                
                                    
                
                <!-- <p>out index:3</p>
                <p>size: 3</p> -->
                
                
                                    
                
                <!-- <p>out index:4</p>
                <p>size: 3</p> -->
                
            </p>
            <p class="meta-info"><i class="fa fa-info-circle"></i>
                <a rel="external nofollow" id='index-query' href="http://www.baidu.com/s?wd=http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html" _target="_blank"
                    title="度娘怜爱" target="_blank">&nbsp;<font style='color: #0d31bc; font-size: 16px;'>百度收录</font></a>
            </p>
        </div>
    </div>
</section>

<script>
    var initUrl = "http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html";
    var a = document.createElement('a');
    a.href = initUrl;
    var hostname = a.hostname;
    if(hostname.indexOf('github.io') > -1)
    {
        var newUrl = replace('geekplayers.com', 'yanglr.github.io');
    }
    $("a#index-query").attr("href", newUrl);

    $(document).ready(function(){

        $('.geopattern').each(function(){
            $(this).geopattern($(this).data('pattern-id'));
        });

    });
</script>

<div class="post container" itemscope="" itemtype="http://schema.org/BlogPosting">
    <div class="markdown-body">
        <style>
    nav, section {
        display: block;
    }

    .breadcrumb {
        display: flex;
        flex-wrap: wrap;
        padding: .75rem 1rem;
        margin-bottom: 1rem;
        list-style: none;
        background-color: #f8f9fa;
        border-radius: .25rem
    }

    .breadcrumb-item {
        display: flex
    }

    .breadcrumb-item+.breadcrumb-item {
        padding-left: .5rem
    }

    .breadcrumb-item+.breadcrumb-item::before {
        display: inline-block;
        padding-right: .5rem;
        color: #6c757d;
        content: "/"
    }

    .breadcrumb-item+.breadcrumb-item:hover::before {
        text-decoration: underline
    }

    .breadcrumb-item+.breadcrumb-item:hover::before {
        text-decoration: none
    }

    .breadcrumb-item.active {
        color: #6c757d
    }

    .border-secondary {
        border-color: #6c757d !important;
    }

    .border {
        border: 1px solid #dee2e6 !important;
    }

    .breadcrumb {
        display: flex;
        flex-wrap: wrap;
        padding: .75rem 1rem;
        margin-bottom: 1rem;
        list-style: none;
        background-color: #f8f9fa;
        border-radius: .25rem;
    }

    ol, ul, dl {
        margin-top: 0;
        margin-bottom: 1.5rem !important;;
    }

    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    ol {
        display: block;
        list-style-type: decimal;
        margin-block-start: 1em;
        margin-block-end: 1em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
        padding-inline-start: 40px;
    }

    ol ol,
    ul ul,
    ol ul,
    ul ol {
        margin-bottom: 0
    }
</style>

<nav aria-label="breadcrumb">
    <div class="breadcrumbs">
        <ol class="breadcrumb border border-secondary" itemprop="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">

            
            

            <span><i class="fa fa-anchor"></i>&nbsp;当前位置:&nbsp;</span>
            


<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem" class="breadcrumb-item">
    
    <a itemprop="item" itemtype="https://schema.org/Thing" href="/">
        
        <span itemprop="name"><i class="fa fa-home" aria-hidden="true"></i></span>
        
        <span itemprop="name">主页</span>
    </a>
    <meta itemprop="position" content="1" />
    
</li>
            &nbsp;/&nbsp;
            

            
            
            
            <a href="/categories/wpf" itemprop="item" title="WPF">
                <span itemprop="name">WPF</span>
            </a>&nbsp;/&nbsp;
            
            <a href="/categories/c" itemprop="item" title="C++">
                <span itemprop="name">C++</span>
            </a>&nbsp;/&nbsp;
            
            
            
            

            
            
            
            

            
            
            
            

            
            
            
            
            
            <!-- Add post title or .md file containing folder name in the end postion of breadcrumbs -->
            
            
            

            
            
            
            

            
            <font style="color: #6c757d;">2020</font>
            
            
        </ol>
        
    </div>
</nav>
    </div>
</div>

<article class="post container" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="row">

        
        <div class="col-md-9 markdown-body">

            <h1 id="用visual-c创建wpf项目的三种主要方法">用Visual C++创建WPF项目的三种主要方法</h1>

<p><strong>The problem with using XAML from C++</strong></p>

<p><br /></p>

<p>Because C++ doesn’t support partial class definitions, it isn’t possible to directly support XAML in VC++ projects using this mechanism. That isn’t, however, the core reason why VC++ doesn’t directly support XAML. In addition to using the x:Class attribute, you can also use the x:Subclass attribute so that the XAML gets compiled into the class specified by the x:Class attribute, and the code behind will define the class specified by x:Subclass, which will be derived from the x:Class type. Thus, the lack of partial classes isn’t that big of a block. The main issue is that, right now, no 100-percent CodeDOM support is available to convert</p>

<p>the XAML to C++, and that is the single biggest reason why VC++ doesn’t support XAML intrinsically. I don’t know this for sure, but it’s possible that on a later date, the Visual C++ team may work on their CodeDOM support and provide a fully functional XAML-to-C++ converter. Once that’s available, XAML support can be integrated into VC++ projects. As of today, however, that isn’t an option.</p>

<p><br /></p>

<p>NOTE: <em>CodeDOM</em> is a term used to represent a bunch of types available in the System.</p>

<p>CodeDom namespace that lets you abstract code into an object model. Source code is represented using the CodeDOM tree and can be converted into source code for a specific language using the CodeDOM code generator for that specific language.</p>

<p><br /></p>

<p>Still, the fact that you can’t directly use XAML in a Visual C++ project doesn’t mean that WPF applications can’t be written with Visual C++.</p>

<p><br /></p>

<h2 id="three-ways-to-write-wpf-apps-using-vc">Three ways to write WPF apps using VC++</h2>

<p>You can use three different approaches to write WPF applications using Visual C++. Each has its pros and cons, and we’ll cover each of these approaches in the next section:</p>

<ul>
  <li><em>Use procedural code.</em></li>
</ul>

<p>For one thing, you can directly use procedural code to</p>

<p>write Avalon-based applications and avoid using XAML. Of course, if you</p>

<p>do that, you automatically give up the advantages of declarative programming</p>

<p>that XAML brings in, but for certain scenarios, procedural code often</p>

<p>serves the purpose well.</p>

<ul>
  <li><em>Dynamically load</em> <em>XAML</em>.</li>
</ul>

<p>Alternatively, you can dynamically load XAML during runtime to create your Avalon windows, although the disadvantage is that you’d be distributing a bunch of XAML files with your application.</p>

<ul>
  <li><em>Derive from a class in a</em> <em>C# DLL</em></li>
</ul>

<p>A third technique uses a C# project to create your XAML-based Avalon controls and have a class (or classes) in your C++ project that derives from the classes in the C#-based Avalon DLL. With that mechanism, the UI is created using XAML in the C# project, and the business logic is kept in the C++ project.</p>

<p>When you’re developing WPF applications with C++, you can use one or more of these approaches to achieve whatever functionality you want. In the next section, you’ll see how to write a simple WPF app with C++/CLI using each of the three techniques mentioned here.</p>

<h2 id="72-using-ccli-to-write-a-wpf-application">7.2 Using C++/CLI to write a WPF application</h2>

<p>If Visual C++ doesn’t have support for XAML, and there are no project templates for building an Avalon application (as of the June 2006 CTP), how much extra effort does it take to write Avalon applications using C++? In this section, you’ll find out. You’ll put the three different techniques I described at the end of section</p>

<p>7.1.2 into action. All three mechanisms have their advantages and disadvantages; you can decide which is most suitable for your specific scenario. First, though, let’s briefly go over how to create a new C++/CLI project for Avalon.</p>

<h3 id="721-creating-a-new-ccli-avalon-project">7.2.1 Creating a new C++/CLI Avalon project</h3>

<p>Avalon is a managed framework, and as such any Visual C++ project that needs to access and use Avalon needs to have the /clr compilation mode turned on.</p>

<p>Creating a new C++/CLI project with support for Avalon is fortunately not a difficult task. Table 7.1 lists the few simple steps you need to follow each time you create an application (or library, as the case might be) that uses Avalon.</p>

<p>Table 7.1 Steps to create a C++/CLI Avalon project</p>

<table>
  <thead>
    <tr>
      <th><strong>Step Action</strong></th>
      <th><strong>How To</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1 Generate a new project</td>
      <td>Using the application wizard, specify the CLR Empty Project template.</td>
    </tr>
    <tr>
      <td>2 Set the SubSystem to   /SUBSYSTEM:WINDOWS</td>
      <td>Apply this change in the Project properties, Linker settings, System   sub-setting.</td>
    </tr>
    <tr>
      <td>3 Set the Entry Point to main</td>
      <td>From Project properties, choose Linker settings and then the Advanced   sub-setting.</td>
    </tr>
    <tr>
      <td>4 Add references to the following assemblies:   System   PresentationCore   PresentationFramework   WindowsBase</td>
      <td>Note: Except for System, the other three are required for Avalon.</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>At this point, your empty project is ready for writing Avalon code. Of course, you don’t have any code yet to compile, but you’ll fix that soon.</p>

<p><br /></p>

<h3 id="722-using-procedural-code">7.2.2 Using procedural code</h3>

<p>You’ll now write your first Avalon application using C++/CLI, and you’ll do so entirely using procedural code. Think of it as analogous to an instruction book for putting together a table that contains only textual instructions (analogous to the procedural code) and no pictures (analogous to the XAML).</p>

<p>Create a new CLR project using the steps outlined in the previous section, and add an App.cpp file to it (you can call it whatever you want). Listing 7.2 shows the code for the simplest Avalon application that shows a window onscreen.</p>

<p>Listing 7.2 A simple Avalon app in procedural code
<img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf0.png" alt="img1" /></p>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf1.png" alt="img2" /></p>

<p><br /></p>

<p>If you compile and run the application, you’ll see a window onscreen that can be moved, resized, minimized, maximized, and closed. Avalon requires you to set the COM threading model to single threaded apartment (STA). You do so using the STAThread attribute on the main function <strong>①</strong>. You then create a new instance of the Application object (using gcnew) and invoke the Run method on that instance, passing in a new instance of a Window object (again using gcnew) <strong>②</strong>. The Application class represents an Avalon application and provides the core functionality for running the application. It has a Run method that is called to initiate the application’s main thread. The Run method has an overload that accepts a Window object, which you use in the code. This overload launches the application and uses the specified Window as the main application window. The Window class represents the core functionality of a window and by default provides you with basic windowing functionality such as moving, resizing, and so on, which you verified when you ran the application and saw a fully functional window onscreen.</p>

<p><strong>Note:</strong> Those of you who have an MFC background may see a faint similarity between this model and MFC, where the CWinApp class is analogous to the Application class, and the CFrameWnd class is analogous to the Window</p>

<p>class. CWinApp has a Run method that provides the default message loop, and Application::Run does something similar. Of course, you shouldn’t infer too much from these minor similarities because they’re totally different UI programming models, but it’s possible that a similar design model was used by the architects of Avalon.</p>

<p>This little program doesn’t have a lot of functionality; it just uses the default Window object to create and show a window onscreen. Let’s write a more refined application with its own Application-derived object as well as a window with some controls. Figure 7.4 shows a screenshot of what the enhanced application</p>

<p>will look like.</p>

<p>The main steps involved would be to derive two classes-one from the Window class, and the other from the Application class. You’ll start with the Window-derived class.</p>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf2.png" alt="FirstAvalonApp" /></p>

<p>Figure 7.4</p>

<p>Enhanced WPF app in C++ (procedural code)</p>

<p><em>Writing the Window-derived class</em></p>

<p>The first thing you’ll do is add a new class called FirstWindow to your project, which will be derived from the Window class. You’ll also add some member variables for the various controls and set some of the window properties in the constructor. Listing 7.3 shows the code once you’ve done that.</p>

<p>Listing 7.3 A more functional Avalon app in procedural code</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="o">::</span><span class="n">Windows</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="o">::</span><span class="n">Windows</span><span class="o">::</span><span class="n">Controls</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf3.png" alt="img6" /></p>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf4.png" alt="img7" /></p>

<p>It’s much like Windows Forms programming, except that the controls you declare <strong>①.</strong> are from the System::Windows::Controls namespace (which contains various WPF controls). You set properties like Title, Width, Height, and so on on the window object in the constructor ②. There’s also a call to a method called InitControls ③, where you initialize the child controls (I put it into a separate method to improve the code’s readability). Listing 7.4 shows the InitControls method. Basically, you instantiate each of the child controls, instantiate a container control, add the child controls to the container controls, and finally set the container control as the main Content of the parent window.</p>

<p>Listing 7.4 Function to initialize the Avalon controls</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">InitControls</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
      <span class="n">listbox</span> <span class="o">=</span> <span class="n">gcnew</span> <span class="n">ListBox</span><span class="p">();</span>
      <span class="n">listbox</span><span class="o">-&gt;</span><span class="n">Width</span> <span class="o">=</span> <span class="mi">180</span><span class="p">;</span>

      <span class="n">listbox</span><span class="o">-&gt;</span><span class="n">Height</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>

      <span class="n">Canvas</span><span class="o">::</span><span class="n">SetTop</span><span class="p">(</span><span class="n">listbox</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

      <span class="n">Canvas</span><span class="o">::</span><span class="n">SetLeft</span><span class="p">(</span><span class="n">listbox</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

      <span class="n">textbox</span> <span class="o">=</span> <span class="n">gcnew</span> <span class="n">TextBox</span><span class="p">();</span>

      <span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Width</span> <span class="o">=</span> <span class="mi">180</span><span class="p">;</span>

      <span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Height</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span>
    
      <span class="n">Canvas</span><span class="o">::</span><span class="n">SetTop</span><span class="p">(</span><span class="n">textbox</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

      <span class="n">Canvas</span><span class="o">::</span><span class="n">SetLeft</span><span class="p">(</span><span class="n">textbox</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>

      <span class="n">addbutton</span> <span class="o">=</span> <span class="n">gcnew</span> <span class="n">Button</span><span class="p">();</span>

      <span class="n">addbutton</span><span class="o">-&gt;</span><span class="n">Width</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>

      <span class="n">addbutton</span><span class="o">-&gt;</span><span class="n">Height</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span>

      <span class="n">addbutton</span><span class="o">-&gt;</span><span class="n">Content</span> <span class="o">=</span> <span class="s">"Add"</span><span class="p">;</span>

      <span class="n">Canvas</span><span class="o">::</span><span class="n">SetTop</span><span class="p">(</span><span class="n">addbutton</span><span class="p">,</span> <span class="mi">45</span><span class="p">);</span>

      <span class="n">Canvas</span><span class="o">::</span><span class="n">SetLeft</span><span class="p">(</span><span class="n">addbutton</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>

      <span class="n">addbutton</span><span class="o">-&gt;</span><span class="n">Click</span> <span class="o">+=</span> <span class="n">gcnew</span> <span class="n">RoutedEventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">FirstWindow</span><span class="o">::</span><span class="n">OnAddButtonClick</span><span class="p">);</span>

      <span class="n">maincanvas</span> <span class="o">=</span> <span class="n">gcnew</span> <span class="n">Canvas</span><span class="p">();</span>

      <span class="n">maincanvas</span><span class="o">-&gt;</span><span class="n">Children</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="n">listbox</span><span class="p">);</span>

      <span class="n">maincanvas</span><span class="o">-&gt;</span><span class="n">Children</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="n">textbox</span><span class="p">);</span>

      <span class="n">maincanvas</span><span class="o">-&gt;</span><span class="n">Children</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="n">addbutton</span><span class="p">);</span>

      <span class="n">Content</span> <span class="o">=</span> <span class="n">maincanvas</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf5.png" alt="img" /></p>

<p><br /></p>

<p>Again, you probably notice the similarity with Windows Forms programming.</p>

<p>You instantiate the child controls ①, ②, and ③, and set various properties like Width and Height, and you also use the Canvas::SetTop and Canvas::SetLeft methods to position them on their container. For the button control, you also add an event handler for the Click event ④. Then, you instantiate the Canvas control (which is a container control for other child controls) and add the child controls as its children ⑤. Finally, you set the Content property of the window to this Canvas control ⑥.</p>

<p>Now, you need to add the Click event handler for the button control, where you add the text entered into the TextBox to the ListBox:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">OnAddButtonClick</span><span class="p">(</span><span class="n">Object</span><span class="o">^</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span><span class="o">^</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">listbox</span><span class="o">-&gt;</span><span class="n">Items</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Text</span><span class="p">);</span>
	<span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Text</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
	<span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Focus</span><span class="p">();</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Notice that you set the text of the TextBox to an empty string once you’ve added it to the ListBox. You also call the Focus() method so that the user can continue</p>

<p>adding more entries into the ListBox. The Window-derived class is ready. Let’s now write the Application-derived class.</p>

<p><em>Writing the Application-derived class</em></p>

<p>You derive a class called FirstApp from Application and add an override for the OnStartup method where you create and show the main window:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="cp">#include "FirstWindow.h"
</span>
<span class="n">ref</span> <span class="k">class</span> <span class="nc">FirstApp</span> <span class="o">:</span> <span class="n">Application</span>
<span class="p">{</span>
<span class="nl">public:</span>
<span class="n">FirstApp</span><span class="p">(</span><span class="kt">void</span><span class="p">){}</span>

<span class="nl">protected:</span>
      <span class="k">virtual</span> <span class="kt">void</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">StartupEventArgs</span><span class="o">^</span> <span class="n">e</span><span class="p">)</span> <span class="k">override</span>
      <span class="p">{</span>
          <span class="n">Application</span><span class="o">::</span><span class="n">OnStartup</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
          <span class="n">FirstWindow</span><span class="o">^</span> <span class="n">mainwnd</span> <span class="o">=</span> <span class="n">gcnew</span> <span class="n">FirstWindow</span><span class="p">();</span>
          <span class="n">mainwnd</span><span class="o">-&gt;</span><span class="n">Show</span><span class="p">();</span>
      <span class="p">}</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The OnStartup method is called, not surprisingly, when the application has just started. You override that function so that you can instantiate and show the window.</p>

<p>The base function is responsible for invoking any event handlers associated with the Startup event, and thus you need to call the base method in the override.</p>

<p>Now, all that’s left is to modify the main function to use the custom Application object instead of the default, as shown here:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="cp">#include "FirstApp.h"
</span>
<span class="p">[</span><span class="n">STAThread</span><span class="p">]</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="n">array</span><span class="o">&lt;</span><span class="n">String</span><span class="o">^&gt;^</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">gcnew</span> <span class="n">FirstApp</span><span class="p">())</span><span class="o">-&gt;</span><span class="n">Run</span><span class="p">();</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Notice that you don’t specify a window object to the Run method, because the window object is created in the OnStartup override of your Application-derived class.</p>

<p>Compile and run the application, and try entering some text into the TextBox and clicking the Add button. You should see the text being entered into the ListBox.</p>

<p>When you use procedural code with Avalon, it’s much like using Windows Forms, where you derive classes from the default controls, set some properties, add some event handlers, and are done. Procedural code is all right to develop WPF applications for simple user interfaces, but sometimes it makes better sense</p>

<p>to take advantage of XAML and declarative programming. As I’ve mentioned a few times already, XAML isn’t directly supported in VC++, so you’ll have to look at alternate options to make use of XAML. One such option is to dynamically load the XAML at runtime.</p>

<h3 id="723-dynamically-loading-xaml">7.2.3 Dynamically loading XAML</h3>

<p>In this section, you’ll rewrite the application you wrote in the previous section, using dynamically loaded XAML. This way, you get to leverage the power of XAML and declarative programming (which you couldn’t in the procedural code technique you used in the previous section). Continuing the instruction-book analogy, this will be like one that has textual instructions that refer to pictures (which describe the various steps needed) and are loosely distributed along with the book but not directly printed in the book. You’ll define the UI using XAML instead of procedural code. When you’re done, you’ll have an identical application</p>

<p>to the one you previously created.</p>

<p>Create a new C++/CLI Avalon project using the steps mentioned in the introduction to section 7.2, and call it FirstAvalonDynamic (or whatever you want to call it). The first thing you’ll do is write the XAML (MainWindow.xaml) that represents the UI; see listing 7.5.</p>

<p>Listing 7.5 XAML for the main window</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;Window</span>

      <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>

      <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>

      <span class="na">Title=</span><span class="s">"First Avalon App (dynamically load XAML)"</span>

      <span class="na">Height=</span><span class="s">"400"</span> <span class="na">Width=</span><span class="s">"400"</span>

      <span class="na">ResizeMode=</span><span class="s">"NoResize"</span>

      <span class="nt">&gt;</span> 

      <span class="nt">&lt;Canvas&gt;</span>
            <span class="nt">&lt;ListBox</span> <span class="na">Canvas.Left=</span><span class="s">"10"</span> <span class="na">Canvas.Top=</span><span class="s">"10"</span>
                  <span class="na">Width=</span><span class="s">"180"</span> <span class="na">Height=</span><span class="s">"350"</span>
                  <span class="na">Name=</span><span class="s">"listbox"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;TextBox</span> <span class="na">Canvas.Left=</span><span class="s">"200"</span> <span class="na">Canvas.Top=</span><span class="s">"10"</span>
                  <span class="na">Width=</span><span class="s">"180"</span> <span class="na">Height=</span><span class="s">"25"</span>
                  <span class="na">Name=</span><span class="s">"textbox"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Button</span> <span class="na">Canvas.Left=</span><span class="s">"200"</span> <span class="na">Canvas.Top=</span><span class="s">"45"</span>
                  <span class="na">Width=</span><span class="s">"80"</span> <span class="na">Height=</span><span class="s">"25"</span>
                  <span class="na">Name=</span><span class="s">"addbutton"</span><span class="nt">&gt;</span>Add<span class="nt">&lt;/Button&gt;</span>
      <span class="nt">&lt;/Canvas&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The XAML shown does exactly what you did with the procedural code earlier. For the control elements, you use the same names using the Name attribute as you use for the member variables in the procedural code. Next, you need to hook an event handler to the Button so that the text entered into the TextBox is inserted</p>

<p>into the ListBox. For that, you’ll write a helper class, as shown in listing 7.6.</p>

<p>Listing 7.6 <strong>WindowHelper</strong> class that implements the event handler</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="o">::</span><span class="n">Windows</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="o">::</span><span class="n">Windows</span><span class="o">::</span><span class="n">Controls</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="o">::</span><span class="n">Windows</span><span class="o">::</span><span class="n">Markup</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="o">::</span><span class="n">IO</span><span class="p">;</span>

<span class="n">ref</span> <span class="k">class</span> <span class="nc">WindowHelper</span>
<span class="p">{</span>

      <span class="n">ListBox</span><span class="o">^</span> <span class="n">listbox</span><span class="p">;</span>

      <span class="n">TextBox</span><span class="o">^</span> <span class="n">textbox</span><span class="p">;</span>

      <span class="n">Button</span><span class="o">^</span> <span class="n">addbutton</span><span class="p">;</span>

 

<span class="nl">public:</span>
<span class="n">WindowHelper</span><span class="p">(</span><span class="n">Window</span><span class="o">^</span> <span class="n">window</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">addbutton</span> <span class="o">=</span> <span class="p">(</span><span class="n">Button</span><span class="o">^</span><span class="p">)</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">FindName</span><span class="p">(</span><span class="s">"addbutton"</span><span class="p">);</span>

	<span class="n">textbox</span> <span class="o">=</span> <span class="p">(</span><span class="n">TextBox</span><span class="o">^</span><span class="p">)</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">FindName</span><span class="p">(</span><span class="s">"textbox"</span><span class="p">);</span>

	<span class="n">listbox</span> <span class="o">=</span> <span class="p">(</span><span class="n">ListBox</span><span class="o">^</span><span class="p">)</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">FindName</span><span class="p">(</span><span class="s">"listbox"</span><span class="p">);</span>

	<span class="n">addbutton</span><span class="o">-&gt;</span><span class="n">Click</span> <span class="o">+=</span> <span class="n">gcnew</span> <span class="n">RoutedEventHandler</span><span class="p">(</span>

	<span class="k">this</span><span class="p">,</span><span class="o">&amp;</span><span class="n">WindowHelper</span><span class="o">::</span><span class="n">OnAddButtonClick</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">OnAddButtonClick</span><span class="p">(</span><span class="n">Object</span><span class="o">^</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span><span class="o">^</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">listbox</span><span class="o">-&gt;</span><span class="n">Items</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Text</span><span class="p">);</span>

	<span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Text</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>

	<span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Focus</span><span class="p">();</span>
<span class="p">}</span>

<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf6.png" alt="img13" /></p>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf7.png" alt="img14" /></p>

<p>The WindowHelper constructor accepts a Window argument and uses the FindName method ① to get the control with the specified identifier (which maps to the Name attributes you used in the XAML). You also hook an event handler to the addbutton control ②. Finally, you have the event handler③, which is identical to the one you used in the procedural code project. Listing 7.7 shows the code for the Application-derived class, where you override OnStartup as before, except that you create a window dynamically by loading the XAML file from the disk.</p>

<p>Listing 7.7 The <strong>Application</strong>-derived class</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="n">ref</span> <span class="k">class</span> <span class="nc">FirstAppDynamic</span> <span class="o">:</span> <span class="n">Application</span>

<span class="p">{</span>

<span class="nl">public:</span>

      <span class="n">FirstAppDynamic</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
      <span class="p">{</span>

      <span class="p">}</span>

<span class="nl">protected:</span>
      <span class="k">virtual</span> <span class="kt">void</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">StartupEventArgs</span><span class="o">^</span> <span class="n">e</span><span class="p">)</span> <span class="k">override</span>
      <span class="p">{</span>

            <span class="n">Application</span><span class="o">::</span><span class="n">OnStartup</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>

            <span class="n">Stream</span><span class="o">^</span> <span class="n">st</span> <span class="o">=</span> <span class="n">File</span><span class="o">::</span><span class="n">OpenRead</span><span class="p">(</span><span class="s">"MainWindow.xaml"</span><span class="p">);</span>

            <span class="n">Window</span><span class="o">^</span> <span class="n">mainwnd</span> <span class="o">=</span> <span class="p">(</span><span class="n">Window</span><span class="o">^</span><span class="p">)</span><span class="n">XamlReader</span><span class="o">::</span><span class="n">Load</span><span class="p">(</span><span class="n">st</span><span class="p">);</span>

            <span class="n">st</span><span class="o">-&gt;</span><span class="n">Close</span><span class="p">();</span>

            <span class="n">WindowHelper</span><span class="o">^</span> <span class="n">mainwndhelper</span> <span class="o">=</span> <span class="n">gcnew</span> <span class="n">WindowHelper</span><span class="p">(</span><span class="n">mainwnd</span><span class="p">);</span>

            <span class="n">mainwnd</span><span class="o">-&gt;</span><span class="n">Show</span><span class="p">();</span>

      <span class="p">}</span>

<span class="p">};</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf8.png" alt="img15" /></p>

<p>You open a file stream to the XAML using File::OpenRead ① and use the overload of XamlReader::Load ② that takes a Stream^ as parameter to create a Window object. This Load method works the magic, by reading and parsing the XAML and building a Window object out of it. You instantiate the WindowHelper object and pass</p>

<p>this Window object as the argument, so that the event handler for the addbutton control is properly set up ③. You then show the window ④ with a call to Show().</p>

<p>The main method is much the same as before, where you instantiate the Application object and call Run on it:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="n">STAThread</span><span class="p">]</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="n">array</span><span class="o">&lt;</span><span class="n">String</span><span class="o">^&gt;^</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>

      <span class="k">return</span> <span class="p">(</span><span class="n">gcnew</span> <span class="n">FirstAppDynamic</span><span class="p">())</span><span class="o">-&gt;</span><span class="n">Run</span><span class="p">();</span>

<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The advantage of using this technique over using procedural code is that you get to design your UI in XAML, thereby achieving a level of UI/code separation. You can also use Cider or some other XAML designer to quickly design flexible user interfaces, which would involve a good bit of hand-coding in procedural code.</p>

<p>The disadvantage is that you have to distribute the XAML file with your application, and if you have multiple windows, you then need that many XAML files.</p>

<p>There’s always the risk of a loosely-distributed XAML file getting corrupted (accidentally or otherwise) or even being deleted. You can embed all the XAML files as resources in the C++/CLI assembly and load them at runtime, but even that involves a lot of extra work. To avoid distributing XAML files loosely with your</p>

<p>application or embedding them as resources, you may want to use the technique we’ll discuss in the next section: putting the XAML into a C# project and accessing it via a derived class in a C++ project.</p>

<h3 id="724-deriving-from-a-class-in-a-c-dll">7.2.4 Deriving from a class in a C# DLL</h3>

<p>You’ll write a third variation of the same application in this section. You’ll use a C# control library project for the XAML, and a C++ project that will utilize that XAML control by deriving a control from it. Using the instruction-book analogy again, this is essentially a picture-based, step-by-step guide with the textual</p>

<p>instructions printed alongside each picture providing some meta-information for the step indicated by that picture. First, use the New Project Wizard to generate a new C# .NET 3.0 Custom Control Library project, and delete the default XAML file generated by the wizard. The default XAML is derived from User-</p>

<p>Control and isn’t what you want. Add a new XAML file to the C# project that represents a Window, and either use Cider or hand-code the XAML from listing 7.8 into that file.</p>

<p>Listing 7.8 The <strong>Window</strong> class definition using XAML</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"CSXamlLibrary.BaseWindow"</span>
      <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
      <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
      <span class="na">Title=</span><span class="s">"First Avalon App (dynamically load XAML)"</span>
      <span class="na">Height=</span><span class="s">"400"</span> <span class="na">Width=</span><span class="s">"400"</span>
      <span class="na">ResizeMode=</span><span class="s">"NoResize"</span>
      <span class="nt">&gt;</span> 

      <span class="nt">&lt;Canvas&gt;</span>
            <span class="nt">&lt;ListBox</span> <span class="na">Canvas.Left=</span><span class="s">"10"</span> <span class="na">Canvas.Top=</span><span class="s">"10"</span>
                  <span class="na">Width=</span><span class="s">"180"</span> <span class="na">Height=</span><span class="s">"350"</span>
                  <span class="na">Name=</span><span class="s">"listbox"</span> <span class="na">x:FieldModifier=</span><span class="s">"protected"</span> <span class="nt">/&gt;</span>

            <span class="nt">&lt;TextBox</span> <span class="na">Canvas.Left=</span><span class="s">"200"</span> <span class="na">Canvas.Top=</span><span class="s">"10"</span>
                  <span class="na">Width=</span><span class="s">"180"</span> <span class="na">Height=</span><span class="s">"25"</span>
                  <span class="na">Name=</span><span class="s">"textbox"</span> <span class="na">x:FieldModifier=</span><span class="s">"protected"</span> <span class="nt">/&gt;</span>

            <span class="nt">&lt;Button</span> <span class="na">Canvas.Left=</span><span class="s">"200"</span> <span class="na">Canvas.Top=</span><span class="s">"45"</span>
                  <span class="na">Width=</span><span class="s">"80"</span> <span class="na">Height=</span><span class="s">"25"</span>
                  <span class="na">Name=</span><span class="s">"addbutton"</span> <span class="na">x:FieldModifier=</span><span class="s">"protected"</span><span class="nt">&gt;</span>Add<span class="nt">&lt;/Button&gt;</span>
      <span class="nt">&lt;/Canvas&gt;</span>

<span class="nt">&lt;/Window&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf9.png" alt="img16" /></p>

<p>The XAML is identical to that used in the previous project (where you dynamically loaded it) except for the x:Class attribute for the Window element, which specifies the name of the class that will be generated, and the x:FieldModifier attributes that are applied to the child control elements so they’re generated as protected members in the class (rather than as private which is the default). Build the C# project, and generate the control library. Once that’s done, create a new C++/CLI Avalon project (using the same steps as before), and then add a reference to this C# project. Now, you can write a new Window class that’s derived from the class in the C# DLL, as shown in listing 7.9.</p>

<p>Listing 7.9 Deriving the main window from the XAML-defined <strong>Window</strong> class</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="o">::</span><span class="n">Windows</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="o">::</span><span class="n">Windows</span><span class="o">::</span><span class="n">Controls</span><span class="p">;</span>

 

<span class="n">ref</span> <span class="k">class</span> <span class="nc">AppMainWindow</span> <span class="o">:</span> <span class="n">CSXamlLibrary</span><span class="o">::</span><span class="n">BaseWindow</span>
<span class="p">{</span>
      <span class="nl">public:</span>
            <span class="n">AppMainWindow</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
            <span class="p">{</span>
                  <span class="n">addbutton</span><span class="o">-&gt;</span><span class="n">Click</span> <span class="o">+=</span> <span class="n">gcnew</span> <span class="n">RoutedEventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">AppMainWindow</span><span class="o">::</span><span class="n">OnAddButtonClick</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="kt">void</span> <span class="n">OnAddButtonClick</span><span class="p">(</span><span class="n">Object</span><span class="o">^</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span><span class="o">^</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>

                  <span class="n">listbox</span><span class="o">-&gt;</span><span class="n">Items</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Text</span><span class="p">);</span>

                  <span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Text</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>

                  <span class="n">textbox</span><span class="o">-&gt;</span><span class="n">Focus</span><span class="p">();</span>

            <span class="p">}</span>

<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://gitee.com/geekplayers/images/raw/master/cpp-wpf10.png" alt="img17" /></p>

<p>The code is similar to what you’ve seen thus far, except that it’s a lot cleaner.</p>

<p>Unlike the first example, you don’t have a lot of clogged procedural code to create the UI. Unlike the second example, you don’t need a helper class to map the XAML elements to the control variables and event handlers. It’s definitely an improvement over the previous two examples, but you have to bring in the C#</p>

<p>project just for the XAML. The rest of the code needed for the application is more or less similar to what you saw earlier:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="n">ref</span> <span class="k">class</span> <span class="nc">FirstAppDerived</span> <span class="o">:</span> <span class="n">Application</span>
<span class="p">{</span>
      <span class="nl">protected:</span>
            <span class="k">virtual</span> <span class="kt">void</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">StartupEventArgs</span><span class="o">^</span> <span class="n">e</span><span class="p">)</span> <span class="k">override</span>
            <span class="p">{</span>
                  <span class="n">Application</span><span class="o">::</span><span class="n">OnStartup</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
                  <span class="n">AppMainWindow</span><span class="o">^</span> <span class="n">mainwnd</span> <span class="o">=</span> <span class="n">gcnew</span> <span class="n">AppMainWindow</span><span class="p">();</span>
                  <span class="n">mainwnd</span><span class="o">-&gt;</span><span class="n">Show</span><span class="p">();</span>
            <span class="p">}</span>

<span class="p">};</span>

<span class="p">[</span><span class="n">STAThread</span><span class="p">]</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="n">array</span><span class="o">&lt;</span><span class="n">String</span><span class="o">^&gt;^</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">gcnew</span> <span class="n">FirstAppDerived</span><span class="p">())</span><span class="o">-&gt;</span><span class="n">Run</span><span class="p">();</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>In some ways, the third technique is a sort of hybrid of the previous two techniques.</p>

<p>A lot of the code is identical to that in the first technique - as with the declaration of a custom class derived from Window and an Application-derived class with the OnStartup method creating the custom window. But, like the second technique, the UI definition is in the XAML, except that in this case, it’s compiled into the C# DLL. You also reduce lines of code with each successive technique. You had the most lines of code with procedural code (as is to be expected) and improved on that considerably when you moved the UI definition to the XAML in the dynamically-loaded XAML example. In the last example, you saved even further on lines of code, such as the helper class from the second example that had to wire the XAML elements to the member variables. Of course, the total lines of code (LOC) isn’t always the single deciding factor that determines what technique you choose. Table 7.2 shows a comparison of the three techniques; for each factor, the cells with the bold text reflect the technique (or techniques) that offer maximum performance (or convenience).</p>

<p>Table 7.2 Comparison of the three techniques</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>Procedural code</th>
      <th>Dynamically load XAML</th>
      <th>XAML in C# DLL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cluttered code that generates the UI</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Dependency on loose XAML files</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Dependency on C#-based DLL</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Lines of code</td>
      <td>Maximum</td>
      <td>In-between</td>
      <td>Minimum</td>
    </tr>
    <tr>
      <td>UI design convenience</td>
      <td>Poor</td>
      <td>Excellent</td>
      <td>Excellent</td>
    </tr>
    <tr>
      <td>UI/business logic separation</td>
      <td>Poor</td>
      <td>Good</td>
      <td>Excellent</td>
    </tr>
    <tr>
      <td>Level of Visual C++ project support</td>
      <td>Total</td>
      <td>Partial</td>
      <td>(Not applicable)</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>It’s hard to pinpoint a specific technique and claim that it’s the best one, because depending on your requirements, each has advantages and disadvantages. Of course, in the future, if Visual C++ has direct support for XAML (as I believe it will), that will be your best option for the majority of scenarios.</p>


            <style>
.PageNav {
  font-size: 14px;
  display: block;
  width: auto;
  overflow: hidden;
}

.PageNav a {
  display: block;
  width: 50%;
  float: left;
  margin: 1em 0;
}

.PageNav .next {
  text-align: right;
}    
</style>

<div style="margin-top:2em; padding:0 1.5em; border:1px solid #d3d3d3; background-color:#deebf7">
    <h3>版权声明</h3>
    <ul>
        <li>本文作者：<a href="" target="_blank">极客玩家大白</a></li>
        <li>本文链接：<a href="/the-methods-using-visual-Cpp-creating-wpf.html" target="_blank">http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html</a></li>
        <li>郑重声明：本文为博主原创或经授权转载的文章，欢迎转载，但<b>转载文章之后必须在文章页面明显位置注明出处</b>，否则保留追究法律责任的权利。如您有任何疑问或者授权方面的协商，请留言。</li>
    </ul>
</div>

<div class="PageNav">
    
    <a class="prev" href="/wpf-data-binding-debug-guide.html"><i class="fa fa-arrow-left"></i>&nbsp;WPF中的Data Binding调试指南</a>
    
    
    <a class="next" href="/visual-cpp-wpf-method.html"> Visual C++中创建WPF项目的方法&nbsp;<i class="fa fa-arrow-right"></i></a>
    
</div>

<div>
    <p align="center">
        
        <img src="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/assets/images/dotnet.jpg" width="300" height="300">
        
        <br />
        一个有故事的程序员
    </p>
    <p align="center" style="margin-top: 15px; font-size: 11px;color: #cc0000;">
        <strong>（转载本站文章请注明作者和出处 <a href="//geekplayers.com">极客玩家大白</a>）</strong>
    </p>
    <p align="center" style="margin-top: 15px; font-size: 16px;color: #337ab7;">
        <strong><a href="//geekplayers.com" target="_blank">点击了解 ：.NET技术人的网站</a></strong>
    </p>
</div>

            <!-- Comments -->
            <div class="comment">
             

  
    <a href="#" class="show_disqus_comment" onclick="return false;">Show Disqus Comments</a>
    <div id="disqus_thread"></div>
    <script>
    var disqus_config = function () {
        this.page.url = 'http://localhost:4000/the-methods-using-visual-Cpp-creating-wpf.html';
        this.page.identifier = '/the-methods-using-visual-Cpp-creating-wpf.html';
        this.page.title = '用Visual C++创建WPF项目的三种主要方法';
    };
    var disqus_loaded = false;
    $(function() {
        $('.show_disqus_comment').on('click', function() { // DON'T EDIT BELOW THIS LINE
            $(this).html('加载中...');
            var that = this;
            if (!disqus_loaded) {
                var d = document, s = d.createElement('script');

                s.type = 'text/javascript';
                s.async = true;
                var shortname = 'yanglr';

                s.src = '//' + shortname + '.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);

                disqus_loaded = true;
            }
            $(that).remove();
        })
    })
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  

  
        <div id="gitalk-container"></div>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/assets/css/gitalk.css"> <!-- 根据 cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css 微调 -->
        <script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
        <script>
        var title = location.pathname.substr(0, 50); //截取路径的前50个字符作为标识符          
        var gitalk = new Gitalk({
            id: title,
            clientID: '22eb6462c987e7a79860',
            clientSecret: '6cd15fa90d4e2f73fa16eaab9b3f783831fe3f3d',
            repo: 'geekplayers.com',
            owner: 'yanglr',
            admin: ['yanglr'],
            labels: ['gitalk'],
            perPage: 50
        })
        gitalk.render('gitalk-container');
        </script>
  


            </div>
        </div>

        <div class="col-md-3">
            <h3>Post Directory</h3>
<div id="post-directory-module">
<section class="post-directory">
    <!-- Links that trigger the jumping -->
    <!-- Added by javascript below -->
    <dl></dl>
</section>
</div>

<script type="text/javascript">

    $(document).ready(function(){
        $( "article h2" ).each(function( index ) {
            $(".post-directory dl").append("<dt><a class=\"jumper\" hre=#" +
                    $(this).attr("id")
                    + ">"
                    + $(this).text()
                    + "</a></dt>");

            var children = $(this).nextUntil("h2", "h3")

            children.each(function( index ) {
                $(".post-directory dl").append("<dd><a class=\"jumper\" hre=#" +
                        $(this).attr("id")
                        + ">"
                        + "&nbsp;&nbsp;- " + $(this).text()
                        + "</a></dd>");
            });
        });

        var fixmeTop = $('#post-directory-module').offset().top - 100;       // get initial position of the element

        $(window).scroll(function() {                  // assign scroll event listener

            var currentScroll = $(window).scrollTop(); // get current position

            if (currentScroll >= fixmeTop) {           // apply position: fixed if you
                $('#post-directory-module').css({      // scroll to that element or below it
                    top: '100px',
                    position: 'fixed',
                    width: 'inherit'
                });
            } else {                                   // apply position: static
                $('#post-directory-module').css({      // if you scroll above it
                    position: 'inherit',
                    width: 'inherit'
                });
            }

        });

        $("a.jumper").on("click", function( e ) {

            e.preventDefault();

            $("body, html").animate({
                scrollTop: ($( $(this).attr('hre') ).offset().top - 100)
            }, 600);

        });
    });

</script>
        </div>
        

    </div>

</article>

<script type="text/javascript">
    const headings = document.querySelectorAll('h2,h3,h4'); // 1
    const linkContent = '<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'; // 2
    for (const heading of headings) { // 3
        const linkIcon = document.createElement('a'); // 4
        
        if(heading.id != '')
        {
            linkIcon.setAttribute('href', `#${heading.id}`); // 5
            linkIcon.innerHTML = linkContent; // 6
            heading.firstChild.textContent = ' ' + heading.firstChild.textContent;
            heading.insertBefore(linkIcon, heading.firstChild);; // 7
        }
    }
</script>
        </div>

    
    <footer class="container">
        <div class="site-footer">
            <!--  <div class="site-footer-icons">
            <a target="_blank" href="https://www.zhihu.com/people/legege007">
               知乎
            </a>
            <a target="_blank" href="http://weibo.com/540071991">
               微博
            </a>
            <a target="_blank" href="https://github.com/yanglr">
                GitHub
            </a>
        </div> -->
            <div class="card text-center">
                <ul class="list-inline" style="margin-left: 0;">
                    <li>
                        <a target="_blank" href="https://github.com/yanglr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/legege007">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a target="_blank" href="https://weibo.com/540071991">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="site-footer-links mobile-hidden">
                
                <a href="/docker.html" title="Docker" target="_blank">Docker</a>
                
                <a href="/open-source.html" title="Code" target="_blank">Code</a>
                
                <a href="/geektime.html" title="极客" target="_blank">极客</a>
                
            </div>
            <!--         <div class="site-footer-icons">
                   沪ICP备20019934号-2
            </div> -->
            <div class="scrolltop">
                粤ICP备12009483号（Gitee站）
                <a href="javascript:window.scrollTo(0,0)">TOP↑</a>
            </div>
            <div class="rss">
                <a href="/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a>
                Power by <a href="https://github.com/DONGChuan/Yummy-Jekyll">Yummy Jekyll</a>
            </div>
        </div>
        <!-- Third-Party JS -->
        <script type="text/javascript" src="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/bower_components/geopattern/js/geopattern.min.js"></script>
        <!-- My JS -->
        <script type="text/javascript" src="//cdn.jsdelivr.net/gh/yanglr/yanglr.github.io/assets/js/script.js"></script>
        

        <!-- Cnzz Analytics -->
        <script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1279049771'%3E%3C/span%3E%3Cscript src='https://v1.cnzz.com/z_stat.php%3Fid%3D1279049771%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));
        </script>
        <!-- Cnzz Analytics -->
    </footer>


    </body>

</html>
